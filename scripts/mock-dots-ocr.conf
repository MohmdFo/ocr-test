server {
    listen 80;
    server_name localhost;

    # Mock health endpoint
    location /health {
        add_header Content-Type application/json;
        return 200 '{"status": "healthy", "service": "dots.ocr", "version": "mock-1.0.0"}';
    }

    # Mock OCR endpoint
    location /ocr {
        if ($request_method = POST) {
            add_header Content-Type application/json;
            return 200 '{
                "success": true,
                "predictions": [
                    {
                        "text": "This is mock OCR text extracted from the uploaded image.",
                        "confidence": 0.95,
                        "bbox": {
                            "x": 10,
                            "y": 20,
                            "width": 200,
                            "height": 30
                        }
                    },
                    {
                        "text": "Additional mock text block with lower confidence.",
                        "confidence": 0.78,
                        "bbox": {
                            "x": 15,
                            "y": 60,
                            "width": 180,
                            "height": 25
                        }
                    }
                ],
                "processing_time": 150,
                "language_detected": "en"
            }';
        }
        
        # Handle non-POST requests
        add_header Content-Type application/json;
        return 405 '{"error": "Method not allowed", "message": "Only POST requests are supported"}';
    }

    # Mock vLLM chat completions endpoint for dots.ocr
    location /v1/chat/completions {
        if ($request_method = POST) {
            add_header Content-Type application/json;
            return 200 '{
                "choices": [
                    {
                        "message": {
                            "content": "Mock OCR result: This is a test OCR response from nginx mock service"
                        }
                    }
                ]
            }';
        }
        
        add_header Content-Type application/json;
        return 405 '{"error": "Method not allowed", "message": "Only POST requests are supported"}';
    }

    # Default location
    location / {
        add_header Content-Type application/json;
        return 404 '{"error": "Not found", "message": "This is a mock dots.ocr service"}';
    }
}
